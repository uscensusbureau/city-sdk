---
layout: exampleslayout
published: true
---

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../../font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.css" />
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

    <title>NYC Boroughs using Leaflet JS</title>

    <script src="http://code.jquery.com/jquery-2.1.4.min.js" type="text/javascript"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.js"></script>

    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=visualization&signed_in=true">
    </script>

    <script src="https://cdn.rawgit.com/uscensusbureau/citysdk/Release1.1/js/citysdk.js"></script>
    <script src="https://cdn.rawgit.com/uscensusbureau/citysdk/Release1.1/js/citysdk.census.js"></script>

    <script>
        var apiKey, map, geojsonLayer;

        var ready = false;
        var NYCgeojson;

        var variables = [];

        var boroughs = {
            "Staten Island": 0,
            "Queens": 1,
            "Brooklyn": 2,
            "Manhattan": 3,
            "Bronx": 4
        };

        var currentBorough = 0;

        jQuery.getJSON("https://cdn.rawgit.com/dwillis/nyc-maps/master/boroughs.geojson", function(response) {
            ready = true;
            NYCgeojson = response;

            NYCgeojson.features[boroughs["Staten Island"]].properties.NAME = "Staten Island";
            NYCgeojson.features[boroughs["Queens"]].properties.NAME = "Queens";
            NYCgeojson.features[boroughs["Brooklyn"]].properties.NAME = "Brooklyn";
            NYCgeojson.features[boroughs["Manhattan"]].properties.NAME = "Manhattan";
            NYCgeojson.features[boroughs["Bronx"]].properties.NAME = "Bronx";
        });

        var sdk = new CitySDK();
        var census = sdk.modules.census;

        var mode = "geometry";

        function getApiKey() {
            census.enable("21ca50e1a3e22cf2b18083748c278199395408ec");
        };

        $(document).ready(
                function() {
                    getApiKey();

                    map = L.map('map').setView([40.7127, -74.0059], 10);

                    L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
                        attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
                        maxZoom: 18,
                        id: 'afrasier.mf7424i4',
                        accessToken: 'pk.eyJ1IjoiYWZyYXNpZXIiLCJhIjoiMjYyYzU5NmQ1YmNiZWE5ODY4YzQ1OTZjMWU3OWI0MGUifQ.jW-UYJNU9AzlrYe-HHIKNQ'
                    }).addTo(map);


                    geojsonLayer = L.geoJson().addTo(map);

                    L.Util.setOptions(geojsonLayer,
                        {
                        style: {
                            "clickable": true,
                            "color": "#ff7800",
                            "weight": 2,
                            "opacity": 0.65
                        },

                        onEachFeature: function (feature, layer) {
                            layer.on('click', function (e) {
                                var popup = "<h4>" + feature.properties.NAME + "</h4>";
                                variables.forEach(function(v) {
                                    popup += "<br/><strong>" + v + "</strong>: " + feature.properties[v];
                                });

                                layer.bindPopup(popup);
                            });
                        }

                        });
                }
        );
        var q;
        function split(x) {
            variables = [];
            $('#variableBox').val().split(",").forEach(function(s) {
                variables.push(s.trim());
            });

            var request = {
                container: mode,
                containerGeometry: census.GEOtoESRI(NYCgeojson.features[currentBorough]).geometry,
                sublevel: true,
                level: x,
                variables: variables
            };

            census.GEORequest(request, function(response) {
                response.features.forEach(function(f) {
                    geojsonLayer.addData(f);
                });
            });
        };

        function clearMap() {
            geojsonLayer.clearLayers();
        };

        function plotBorough(x) {
            clearMap();
            currentBorough = boroughs[x];

            geojsonLayer.addData(NYCgeojson.features[currentBorough]);
        };

        function setMode(x) {
            mode = x;
        };
    </script>
</head>

<body>

    <div class="row">
            <div class="page-header col-md-12">
              <h1>NYC Boroughs using Leaflet JS</h1>
            </div>
    </div>

    <div class="row">
        <div class="btn-group col-md-12">
            <a href="#" class="btn btn-primary" role="button">View the Example</a>
            <a href="http://uscensusbureau.github.io/citysdk/examples/leafletNYC/source.html" class="btn btn-default" role="button">Source Code</a>
        </div>
    </div>

    <div>
                <h3>Overview</h3> 
                <p>There may be situations where you want Census demographic information (such as income or population), but want to use a custom geographical boundary.  This example shows how you can pass in to the CitySDK custom GeoJSON boundaries, in this case NYC borough shapes, and retrieve information that correlates to the custom geographies.  Because the Census boundaries (such as tracts) won't line up perfectly, you need to specify to "include within" or "cross-boundaries".    </p>
    </div>


<div class="container">
    <div class="row">
        <div class="col-md-12">
            <div id="map" style="height:400px;"></div>
        </div>
    </div>

    
    <div class="row" style="margin-top: 1em;">
        <div class="col-md-2">
            <p><a class="btn btn-primary" style="width: 100%;" href="javascript:void(0)" onclick="plotBorough('Staten Island')" role="button"><small>Staten Island</small></a></p>
        </div>
        <div class="col-md-2">
            <p><a class="btn btn-primary" style="width: 100%;" href="javascript:void(0)" onclick="plotBorough('Queens')" role="button"><small>Queens</small></a></p>
        </div>
        <div class="col-md-2">
            <p><a class="btn btn-primary" style="width: 100%;" href="javascript:void(0)" onclick="plotBorough('Brooklyn')" role="button"><small>Brooklyn</small></a></p>
        </div>
        <div class="col-md-2">
            <p><a class="btn btn-primary" style="width: 100%;" href="javascript:void(0)" onclick="plotBorough('Manhattan')" role="button"><small>Manhattan</small></a></p>
        </div>
        <div class="col-md-2">
            <p><a class="btn btn-primary" style="width: 100%;" href="javascript:void(0)" onclick="plotBorough('Bronx')" role="button"><small>Bronx</small></a></p>
        </div>
    </div>
    <div class="row">
        <div class="col-md-2">
            <p><a class="btn btn-success" style="width: 100%;" href="javascript:void(0)" onclick="split('county')" role="button"><small>Plot Counties</small></a></p>
        </div>
        <div class="col-md-2">
            <p><a class="btn btn-success" style="width: 100%;" href="javascript:void(0)" onclick="split('tract')" role="button"><small>Plot Tracts</small></a></p>
        </div>
        <div class="col-md-2">
            <p><a class="btn btn-success" style="width: 100%;" href="javascript:void(0)" onclick="split('blockGroup')" role="button"><small>Plot Blockgroups</small></a></p>
        </div>
        <div class="col-md-2">
            <p><a class="btn btn-warning" style="width: 100%;" href="javascript:void(0)" onclick="setMode('geometry_within')" role="button"><small>Within Only</small></a></p>
        </div>
        <div class="col-md-2">
            <p><a class="btn btn-warning" style="width: 100%;" href="javascript:void(0)" onclick="setMode('geometry')" role="button"><small>Cross-boundaries</small></a></p>
        </div>
    </div>

    <div class="row">
            <div class="col-md-2">
            <p><a class="btn btn-danger" style="width: 100%;" href="javascript:void(0)" onclick="clearMap()" role="button"><small>Clear Map</small></a></p>
        </div>
    </div>

    <div class="row">
        <div class="col-md-3">
            <p>Please enter a comma separated list of <a href="http://uscensusbureau.github.io/citysdk/guides/censusModule/aliases.html">variables</a>:</p>
        </div>
        <div class="col-md-3">
            <input type="text" id="variableBox" type="text" class="form-control" value='income, population'/>
        </div>
    </div>
</div>
</body>
</html>
