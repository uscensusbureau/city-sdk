function decodeAuthHeader(e){var t=e.header("Authorization").split(" "),s=t[1],a=new Buffer(s,"base64");return a.toString().split(":")[0]}function getModuleInstance(e){if(!moduleInstantiated){var t=decodeAuthHeader(e);return census=new CensusModule["default"](t)}return census}var express=require("express"),keyauth=require("./auth.service"),CitySdk=require("../../../dist/node-api/core/citysdk"),CensusModule=require("../../../dist/node-api/modules/census/census.citysdk"),citysdk=new CitySdk["default"],router=express.Router(),moduleInstantiated=!1,census;router.post("/geo",keyauth,function(e,t){getModuleInstance(e).geoRequest(e.body,function(e){t.json(e)})}),router.post("/api",keyauth,function(e,t){getModuleInstance(e).apiRequest(e.body,function(e){t.json(e)})}),router.get("/states",function(e,t){t.json(citysdk.getStates())}),router.get("/state-capitals",function(e,t){t.json(citysdk.getStateCapitals())}),router.get("/aliases",function(e,t){t.json(getModuleInstance(e).getAliases())}),router.get("/variable-to-alias",function(e,t){function s(e){t.status(400).send(e)}if(e.query&&e.query.variables){var a=e.query.variables.split(",");try{var r=getModuleInstance(e).variableToAlias(a);t.json(r)}catch(u){s(u)}}else s("Missing query parameter: variables")}),router.get("/alias-to-variable",function(e,t){function s(e){t.status(400).send(e)}if(e.query&&e.query.aliases){var a=e.query.aliases.split(",");try{var r=getModuleInstance(e).aliasToVariable(a);t.json(r)}catch(u){s(u)}}else s("Missing query parameter: aliases")}),module.exports=router;